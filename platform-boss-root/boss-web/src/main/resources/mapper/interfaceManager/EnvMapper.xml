<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.boss.platform.dao.interfaceManager.EnvMapper">
    <resultMap id="BaseResultMap" type="cn.boss.platform.bean.interfaceManager.EnvBean">
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="item" jdbcType="INTEGER" property="item"/>
        <result column="project_id" jdbcType="INTEGER" property="projectId"/>
        <result column="env" jdbcType="VARCHAR" property="env"/>
        <result column="service" jdbcType="VARCHAR" property="service"/>
        <result column="domain" jdbcType="VARCHAR" property="domain"/>
        <result column="ip" jdbcType="VARCHAR" property="ip"/>
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime"/>
        <result column="update_time" jdbcType="TIMESTAMP" property="updateTime"/>
    </resultMap>

    <!--添加环境 -->
    <insert id="addEnv" parameterType="cn.boss.platform.bean.interfaceManager.EnvBean">
        insert into boss_env_tb (item,project_id,service,env,domain,ip,create_time,update_time)
        VALUES (#{item},#{projectId},#{service},#{env},#{domain},#{ip},#{createTime},#{updateTime});
    </insert>

    <!--查询满足条件参数，返回list -->
    <select id="selectEnv" resultMap="BaseResultMap">
        select * from boss_env_tb where 1=1
        order by id desc limit #{startSize},#{pageSize}
    </select>


    <!--分页查询 -->
    <select id="getEnv" parameterType="cn.boss.platform.bean.interfaceManager.EnvBean" resultMap="BaseResultMap">
        select * from boss_env_tb where 1=1
        <if test="projectId !=null">
            AND project_id = '${projectId}'
        </if>
        <if test="item != null ">
            AND item = '${item}'
        </if>
        ORDER BY id ASC
    </select>


    <!-- 删除环境 -->
    <delete id="deleteEnv" parameterType="java.lang.Integer">
        delete from boss_env_tb where id=#{id}
    </delete>

    <!--通过id获取ip -->
    <select id="getIpByid" resultType="java.lang.String">
        select ip from boss_env_tb where 1=1 AND id='${id}'
    </select>

    <!--通过ip获取bean -->
    <select id="getEnvBeanByip" resultMap="BaseResultMap">
        select * from boss_env_tb where 1=1
        <if test="ip !=null">
            AND ip='${ip}'
        </if>
        <if test="id !=null">
            AND id='${id}'
        </if>
        AND project_id = '${projectId}'
    </select>

    <!--分页查询环境 -->
    <select id="queryEnv"  resultMap="BaseResultMap">
        select * from boss_env_tb where 1=1
        <if test="item !=null">
            AND item = '${item}'
        </if>
        <if test="projectId !=null">
            AND project_id = '${projectId}'
        </if>
        <if test="env != null">
            AND env = '${env}'
        </if>
        ORDER BY id desc limit #{startSize},#{pageSize}
    </select>


    <select id="getEnvById" parameterType="java.lang.Integer" resultMap="BaseResultMap">
        select * from boss_env_tb where 1=1 AND id = #{id}
    </select>

    <!-- 更新环境 -->
    <update id="updateEnv" parameterType="cn.boss.platform.bean.interfaceManager.EnvBean">
        update boss_env_tb
        set
        item = #{item},
        project_id = #{projectId},
        service = #{service},
        env = #{env},
        domain = #{domain},
        ip = #{ip},
        create_time = #{createTime},
        update_time = #{updateTime}
        where id = #{id}
    </update>


</mapper>